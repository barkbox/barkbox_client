  [1m[36m (1.8ms)[0m  [1mCREATE TABLE "auths" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "barkbox_user_id" integer NOT NULL, "access_token" varchar NOT NULL, "access_token_expires_at" datetime, "refresh_token" varchar, "email" varchar, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) [0m
  [1m[35m (0.1ms)[0m  select sqlite_version(*)
  [1m[36m (1.6ms)[0m  [1mCREATE UNIQUE INDEX "index_auths_on_access_token" ON "auths" ("access_token")[0m
  [1m[35m (0.1ms)[0m              SELECT sql
            FROM sqlite_master
            WHERE name='index_auths_on_access_token' AND type='index'
            UNION ALL
            SELECT sql
            FROM sqlite_temp_master
            WHERE name='index_auths_on_access_token' AND type='index'

  [1m[36m (1.5ms)[0m  [1mCREATE  INDEX "index_auths_on_barkbox_user_id" ON "auths" ("barkbox_user_id")[0m
  [1m[35m (1.6ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar NOT NULL) 
  [1m[36m (1.8ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (0.1ms)[0m  SELECT version FROM "schema_migrations"
  [1m[36m (1.6ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20170213224125')[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36m (0.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36m (0.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
Processing by TestController#login as HTML
  Parameters: {"email"=>"test@example.com", "password"=>"[FILTERED]"}
  [1m[36mAuth Load (0.2ms)[0m  [1mSELECT  "auths".* FROM "auths" WHERE "auths"."access_token" = ?  ORDER BY "auths"."id" ASC LIMIT 1[0m  [["access_token", "new_token"]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "auths" ("access_token", "refresh_token", "barkbox_user_id", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?)[0m  [["access_token", "new_token"], ["refresh_token", "refresh_token"], ["barkbox_user_id", 6789], ["created_at", "2017-02-17 19:16:47.332207"], ["updated_at", "2017-02-17 19:16:47.332207"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 58ms (ActiveRecord: 1.2ms)
  [1m[36mAuth Load (0.2ms)[0m  [1mSELECT  "auths".* FROM "auths"  ORDER BY "auths"."id" DESC LIMIT 1[0m
  [1m[35m (1.3ms)[0m  rollback transaction
  [1m[36m (0.3ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "auths" ("barkbox_user_id", "email", "access_token", "refresh_token", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["barkbox_user_id", 1], ["email", "test1@example.com"], ["access_token", "1583361f3249d7581ea01e1be0ca580a"], ["refresh_token", "ce87923b370f74973525bd5c490b468c"], ["created_at", "2017-02-17 19:16:47.348206"], ["updated_at", "2017-02-17 19:16:47.348206"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by TestController#authenticated as HTML
  Parameters: {"access_token"=>"1583361f3249d7581ea01e1be0ca580a"}
  [1m[36mAuth Load (0.1ms)[0m  [1mSELECT  "auths".* FROM "auths" WHERE "auths"."access_token" = ?  ORDER BY "auths"."id" ASC LIMIT 1[0m  [["access_token", "1583361f3249d7581ea01e1be0ca580a"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 3ms (ActiveRecord: 0.1ms)
  [1m[35m (1.6ms)[0m  rollback transaction
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "auths" ("barkbox_user_id", "email", "access_token", "refresh_token", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?)[0m  [["barkbox_user_id", 2], ["email", "test2@example.com"], ["access_token", "4803299ad4d0eecb613ee4128bc3b2cb"], ["refresh_token", "5be7e9f3ac44570cab96b1a1d54f3ece"], ["created_at", "2017-02-17 19:16:47.362562"], ["updated_at", "2017-02-17 19:16:47.362562"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by TestController#authenticated as HTML
  [1m[36mAuth Load (0.1ms)[0m  [1mSELECT  "auths".* FROM "auths" WHERE "auths"."access_token" = ?  ORDER BY "auths"."id" ASC LIMIT 1[0m  [["access_token", "4803299ad4d0eecb613ee4128bc3b2cb"]]
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 1ms (ActiveRecord: 0.1ms)
  [1m[35m (1.2ms)[0m  rollback transaction
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "auths" ("barkbox_user_id", "email", "access_token", "refresh_token", "access_token_expires_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)[0m  [["barkbox_user_id", 3], ["email", "test3@example.com"], ["access_token", "eb9a401b30470b13cc7adf3e9f867af3"], ["refresh_token", "bee2d99bcc561f25b621e8efb83eec71"], ["access_token_expires_at", "2017-02-15 19:16:47.373489"], ["created_at", "2017-02-17 19:16:47.374578"], ["updated_at", "2017-02-17 19:16:47.374578"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by TestController#authenticated as HTML
  [1m[36mAuth Load (0.1ms)[0m  [1mSELECT  "auths".* FROM "auths" WHERE "auths"."access_token" = ?  ORDER BY "auths"."id" ASC LIMIT 1[0m  [["access_token", "eb9a401b30470b13cc7adf3e9f867af3"]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE "auths" SET "access_token" = ?, "access_token_expires_at" = ?, "refresh_token" = ?, "barkbox_user_id" = ?, "updated_at" = ? WHERE "auths"."id" = ?[0m  [["access_token", "new_token"], ["access_token_expires_at", nil], ["refresh_token", "refresh_token"], ["barkbox_user_id", 6789], ["updated_at", "2017-02-17 19:16:47.380407"], ["id", 1]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 10ms (ActiveRecord: 0.8ms)
  [1m[36m (2.0ms)[0m  [1mrollback transaction[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "auths" ("barkbox_user_id", "email", "access_token", "refresh_token", "access_token_expires_at", "created_at", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?)  [["barkbox_user_id", 4], ["email", "test4@example.com"], ["access_token", "377c2abac1b661c6a16871a60643975d"], ["refresh_token", "fbecbef4e2263655596fc8a46ae09e53"], ["access_token_expires_at", "2017-02-16 19:16:47.393271"], ["created_at", "2017-02-17 19:16:47.394596"], ["updated_at", "2017-02-17 19:16:47.394596"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by TestController#authenticated as HTML
  [1m[35mAuth Load (0.1ms)[0m  SELECT  "auths".* FROM "auths" WHERE "auths"."access_token" = ?  ORDER BY "auths"."id" ASC LIMIT 1  [["access_token", "377c2abac1b661c6a16871a60643975d"]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE "auths" SET "access_token_expires_at" = ?, "updated_at" = ? WHERE "auths"."id" = ?  [["access_token_expires_at", "2017-02-17 19:16:47.400677"], ["updated_at", "2017-02-17 19:16:47.401039"], ["id", 1]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.7ms)
  [1m[35m (2.5ms)[0m  rollback transaction
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
Processing by TestController#authenticated as HTML
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  rollback transaction
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
Processing by TestController#login as HTML
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  rollback transaction
